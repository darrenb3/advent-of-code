Had to switch to python here as the problem was a bit complex for my rust skills. Might revisit later to complete in rust.